{"is_source_file": true, "format": "TypeScript", "description": "This file defines a game engine service for a 2D runner game using canvas graphics. It manages player physics, obstacle spawning, collision detection, and keeps track of the score and lives.", "external_files": ["@angular/core"], "external_methods": ["NgZone.runOutsideAngular()"], "published": ["GameEngineService"], "classes": [{"name": "GameEngineService", "description": "Service providing functionality to run a 2D game engine with obstacle management and player interactions."}], "methods": [{"name": "attachCanvas", "description": "Bind the rendering context to the provided canvas and setup engine."}, {"name": "setLevel", "description": "Set current level within the bounds 1..3."}, {"name": "start", "description": "Start the game loop with outside Angular change detection."}, {"name": "stop", "description": "Stop the game loop."}, {"name": "reset", "description": "Reset player, score, lives and obstacles."}, {"name": "update", "description": "Update the game state including player and obstacle movements and collision detection."}, {"name": "jump", "description": "Handle the jump action of the player."}, {"name": "detectCollisions", "description": "Check for collisions between the player and obstacles."}, {"name": "handleHit", "description": "Handle the player being hit by an obstacle, reduces lives and checks for game over."}, {"name": "aabb", "description": "Axis-Aligned Bounding Box collision detection."}, {"name": "draw", "description": "Render the game state on the canvas including player, obstacles, and HUD."}, {"name": "rand", "description": "Generate a random number between min and max."}], "calls": ["NgZone.runOutsideAngular", "requestAnimationFrame", "cancelAnimationFrame", "CustomEvent.dispatchEvent", "HTMLCanvasElement.getContext"], "search-terms": ["GameEngineService", "levelCfgs", "obstacles", "player physics"], "state": 2, "file_id": 23, "knowledge_revision": 92, "git_revision": "", "revision_history": [{"50": ""}, {"68": ""}, {"82": ""}, {"92": ""}], "ctags": [{"_type": "tag", "name": "GameEngineService", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^export class GameEngineService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "LevelConfig", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^export type LevelConfig = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Obstacle", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^type Obstacle = { x: number; y: number; w: number; h: number; color: string };$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "c", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^    const c = this.ctx;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ce", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^        const ce = e as { detail?: number };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "cfg", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^    const cfg = this.levelCfgs[this.level] || this.levelCfgs[1];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ctx", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private ctx: CanvasRenderingContext2D | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "dt", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^          const dt = t2 - this.last;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fallbackStep", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^        const fallbackStep = () => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^      const g: any = typeof globalThis !== 'undefined' ? (globalThis as any) : undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^      const now = g && g.performance && typeof g.performance.now === 'function' ? g.performance./", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^    const g: any = typeof globalThis !== 'undefined' ? (globalThis as any) : undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "gGrad", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^    const gGrad = c.createLinearGradient(0, 0, 0, this.h);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ground", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private ground = 340;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "h", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private h = 400;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "keyset", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private keyset = new Set<string>();$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "last", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private last = 0;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "level", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private level = 1;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "levelCfgs", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private levelCfgs: Record<number, LevelConfig> = {$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "lives", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private lives = 3;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "nextSpawnDelay", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private nextSpawnDelay = 1200;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "now", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^      const now = g && g.performance && typeof g.performance.now === 'function' ? g.performance./", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "o", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^    for (const o of this.obstacles) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "obstacles", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private obstacles: Obstacle[] = [];$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "player", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private player = { x: 80, y: 0, w: 32, h: 32, vy: 0, onGround: false, color: '#2563EB' };$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "raf", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private raf = 0;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "running", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private running = false;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "score", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private score = 0;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "spawnTimer", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private spawnTimer = 0;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}, {"_type": "tag", "name": "step", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^      const step = (t: number) => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "t2", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^          const t2 = Date.now();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "w", "path": "/tmp/kavia/workspace/code-generation/circus-challenge-6895-6904/angular_frontend/src/app/services/game-engine.service.ts", "pattern": "/^  private w = 800;$/", "language": "TypeScript", "kind": "property", "scope": "GameEngineService", "scopeKind": "class"}], "hash": "722e66e8a78b999a8a2c47b49b1331a0", "format-version": 4, "code-base-name": "angular_frontend", "filename": "angular_frontend/src/app/services/game-engine.service.ts", "fields": [{"name": "private ctx: CanvasRenderingContext2D | undefined;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private ground = 340;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private h = 400;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private keyset = new Set<string>();", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private last = 0;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private level = 1;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private levelCfgs: Record<number, LevelConfig> = {", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private lives = 3;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private nextSpawnDelay = 1200;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private obstacles: Obstacle[] = [];", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private player = { x: 80, y: 0, w: 32, h: 32, vy: 0, onGround: false, color: '#2563EB' };", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private raf = 0;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private running = false;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private score = 0;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private spawnTimer = 0;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}, {"name": "private w = 800;", "scope": "GameEngineService", "scopeKind": "class", "description": "unavailable"}]}